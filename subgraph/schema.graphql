type Init @entity(immutable: true) {
  id: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  token: Bytes! # address
}

type Subscribe @entity(immutable: true) {
  id: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  user: Bytes! # address
  start: BigInt! # uint64
  end: BigInt! # uint64
  rate: BigInt! # uint128
}

type Unsubscribe @entity(immutable: true) {
  id: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  user: Bytes! # address
}

type Extend @entity(immutable: true) {
  id: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  user: Bytes! # address
  end: BigInt! # uint64
}

type ActiveSubscription @entity {
  id: Bytes!
  user: Bytes! # address
  start: BigInt! # uint64
  end: BigInt! # uint64
  rate: BigInt! # uint128
  authorizedSigners: [AuthorizedSigner!]
    @derivedFrom(field: "activeSubscription")
}

type AuthorizedSigner @entity {
  id: Bytes! #keccak256 hex string of user:signer
  user: Bytes! #address
  signer: Bytes! #address
  activeSubscription: ActiveSubscription
}
